{"ast":null,"code":"import _regeneratorRuntime from \"/Users/abdifatah/Downloads/final-project-dave3615/react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/abdifatah/Downloads/final-project-dave3615/react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/abdifatah/Downloads/final-project-dave3615/react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/abdifatah/Downloads/final-project-dave3615/react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/abdifatah/Downloads/final-project-dave3615/react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/abdifatah/Downloads/final-project-dave3615/react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/abdifatah/Downloads/final-project-dave3615/react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/abdifatah/Downloads/final-project-dave3615/react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/abdifatah/Downloads/final-project-dave3615/react-app/src/components/Users/UserProfile.js\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport API from \"../../services/api\";\nimport { getOrderHistory as _getOrderHistory, setUser as _setUser } from \"../../store/action/actions\";\n\nvar UserProfile =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(UserProfile, _Component);\n\n  function UserProfile(props) {\n    var _this;\n\n    _classCallCheck(this, UserProfile);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(UserProfile).call(this, props));\n\n    _this.deleteAccount = function () {\n      API.deleteUser(_this.props.user.id).then(function () {\n        _this.setState({\n          deleteConfirmation: true\n        });\n\n        setTimeout(function () {\n          _this.setState({\n            deleteConfirmation: false\n          }, function () {\n            _this.props.setUser(null);\n\n            _this.props.history.push(\"/login\");\n          });\n        }, 3000);\n      });\n    };\n\n    _this.profileChange = function (event, key) {\n      console.log(\"value you are typing: \", event.target.value);\n      console.log(\"updating: \", event.target.id);\n\n      _this.setState(_defineProperty({}, key, event.target.value));\n    };\n\n    _this.changePassword = function (e) {\n      e.preventDefault();\n\n      if (_this.state.password1.trim() === \"\" || _this.state.password2.trim() === \"\") {\n        _this.setState({\n          changePasswordError: true,\n          changePasswordErrorText: \"You have to fill both password fields\"\n        });\n      }\n\n      if (_this.state.password1 !== _this.state.password2) {\n        _this.setState({\n          changePasswordError: true,\n          changePasswordErrorText: \"Passwords must match\"\n        });\n      } else {\n        _this.setState({\n          changePasswordError: false\n        });\n\n        API.changePassword(_this.state.userId, _this.state.password1).then(function () {\n          return _this.setState({\n            changePasswordConfirmation: true\n          }, function () {\n            return setTimeout(function () {\n              _this.setState({\n                changePasswordConfirmation: false\n              });\n\n              _this.props.history.push(\"/login\");\n            }, 3000);\n          });\n        });\n      }\n    };\n\n    _this.profileSubmit =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(event) {\n        var updatedUser, updateShipping;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.preventDefault();\n                updatedUser = _this.props.user;\n                updatedUser[\"firstName\"] = _this.state.firstName;\n                updatedUser[\"lastName\"] = _this.state.lastName;\n                updateShipping = {\n                  id: _this.state.shippingId,\n                  firstName: _this.state.firstName,\n                  lastName: _this.state.lastName,\n                  address: _this.state.address,\n                  city: _this.state.city,\n                  postalCode: _this.state.postalCode,\n                  user_id: _this.props.user.id\n                };\n                API.putShipping(updateShipping).then(function () {\n                  return API.updateUser(updatedUser).then(function () {\n                    _this.setState({\n                      updatConfirmation: true\n                    });\n\n                    setTimeout(function () {\n                      _this.setState({\n                        updatConfirmation: false\n                      });\n                    }, 4000);\n                  });\n                });\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.state = {\n      isLoading: false,\n      firstName: \"Idris\",\n      lastName: \"Hamid\",\n      address: \"\",\n      postalCode: \"\",\n      shippingId: \"\",\n      updatConfirmation: false,\n      deleteConfirmation: false,\n      password1: \"\",\n      password2: \"\",\n      changePasswordError: \"\",\n      changePasswordErrorText: \"\",\n      changePasswordConfirmation: false,\n      userId: \"\"\n    };\n    return _this;\n  }\n\n  _createClass(UserProfile, [{\n    key: \"validateForm\",\n    value: function validateForm() {\n      return this.state.email.length > 0 && this.state.password.length > 0 && this.state.password === this.state.confirmPassword;\n    }\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var _this2 = this;\n\n      var id = this.props.match.params[\"id\"];\n      this.setState({\n        userId: id\n      });\n      API.getUserById(id).then(function (user) {\n        console.log(user);\n        API.getshippingById(user.shippingList[0]).then(function (shippingInfo) {\n          console.log(\"shipping info: \", shippingInfo);\n\n          _this2.setState({\n            firstName: user.firstName,\n            lastName: user.lastName,\n            email: user.email,\n            address: shippingInfo.address,\n            city: shippingInfo.city,\n            postalCode: shippingInfo.postalCode,\n            shippingId: shippingInfo.id\n          });\n        }).catch(function (err) {\n          return console.log(err);\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      console.log(this.state.firstName);\n      return React.createElement(\"div\", {\n        className: \"signup-form\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, this.state.deleteConfirmation && React.createElement(\"div\", {\n        class: \"alert alert-danger mx-auto\",\n        role: \"alert\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, \"The account has been parmenantly deleted\"), this.state.updatConfirmation && React.createElement(\"div\", {\n        class: \"alert alert-success mx-auto\",\n        role: \"alert\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, \"The profile been successfully updated\"), React.createElement(\"form\", {\n        onSubmit: this.profileSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }, \"Profile\"), React.createElement(\"div\", {\n        className: \"form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-xs-6\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        name: \"first_name\",\n        placeholder: \"First Name\",\n        required: \"required\",\n        value: this.state.firstName,\n        onChange: function onChange(event) {\n          return _this3.profileChange(event, \"firstName\");\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"col-xs-6\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        name: \"last_name\",\n        placeholder: \"Last Name\",\n        required: \"required\",\n        value: this.state.lastName,\n        onChange: function onChange(event) {\n          return _this3.profileChange(event, \"lastName\");\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      })))), React.createElement(\"div\", {\n        className: \"form-group\",\n        bsSize: \"large\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        placeholder: \"Address\",\n        value: this.state.address,\n        onChange: function onChange(event) {\n          return _this3.profileChange(event, \"address\");\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group\",\n        bsSize: \"large\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        placeholder: \"city\",\n        value: this.state.city,\n        onChange: function onChange(event) {\n          return _this3.profileChange(event, \"city\");\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group\",\n        bsSize: \"large\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        placeholder: \"postalcode\",\n        value: this.state.postalCode,\n        onChange: function onChange(event) {\n          return _this3.profileChange(event, \"postalCode\");\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-success btn-lg btn-block\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207\n        },\n        __self: this\n      }, \"UPDATE\"))), React.createElement(\"div\", {\n        className: \"form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"btn btn-warning btn-lg btn-block\",\n        \"data-toggle\": \"collapse\",\n        \"data-target\": \"#collapseExample\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }, \"CHANGE PASSWORD\"), React.createElement(\"div\", {\n        class: \"collapse\",\n        id: \"collapseExample\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223\n        },\n        __self: this\n      }, this.state.changePasswordError && React.createElement(\"div\", {\n        class: \"alert alert-danger mx-auto\",\n        role: \"alert\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }, this.state.changePasswordErrorText), this.state.changePasswordConfirmation && React.createElement(\"div\", {\n        class: \"alert alert-success mx-auto\",\n        role: \"alert\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230\n        },\n        __self: this\n      }, \"Password has been successfully changed. Login again.\"), React.createElement(\"div\", {\n        class: \"form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        for: \"exampleInputPassword1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        },\n        __self: this\n      }, \"New password\"), React.createElement(\"input\", {\n        value: this.state.password1,\n        onChange: function onChange(e) {\n          return _this3.setState({\n            password1: e.target.value\n          });\n        },\n        type: \"password\",\n        class: \"form-control\",\n        id: \"exampleInputPassword1\",\n        placeholder: \"Password\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        class: \"form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        for: \"exampleInputPassword1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 247\n        },\n        __self: this\n      }, \"Confirm new password\"), React.createElement(\"input\", {\n        value: this.state.password2,\n        onChange: function onChange(e) {\n          return _this3.setState({\n            password2: e.target.value\n          });\n        },\n        type: \"password\",\n        class: \"form-control\",\n        id: \"exampleInputPassword1\",\n        placeholder: \"Password\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 248\n        },\n        __self: this\n      })), React.createElement(\"button\", {\n        onClick: this.changePassword,\n        type: \"submit\",\n        class: \"btn btn-primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258\n        },\n        __self: this\n      }, \"Change\")))), React.createElement(\"div\", {\n        className: \"form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: this.deleteAccount,\n        className: \"btn btn-danger btn-lg btn-block\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 269\n        },\n        __self: this\n      }, \"DELETE ACCOUNT\")));\n    }\n  }]);\n\n  return UserProfile;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    user: state.rootReducer.user\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    getOrderHistory: function getOrderHistory(id) {\n      return dispatch(_getOrderHistory(id));\n    },\n    setUser: function setUser(user) {\n      return dispatch(_setUser(user));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UserProfile);","map":{"version":3,"sources":["/Users/abdifatah/Downloads/final-project-dave3615/react-app/src/components/Users/UserProfile.js"],"names":["React","Component","connect","API","getOrderHistory","setUser","UserProfile","props","deleteAccount","deleteUser","user","id","then","setState","deleteConfirmation","setTimeout","history","push","profileChange","event","key","console","log","target","value","changePassword","e","preventDefault","state","password1","trim","password2","changePasswordError","changePasswordErrorText","userId","changePasswordConfirmation","profileSubmit","updatedUser","firstName","lastName","updateShipping","shippingId","address","city","postalCode","user_id","putShipping","updateUser","updatConfirmation","isLoading","email","length","password","confirmPassword","match","params","getUserById","getshippingById","shippingList","shippingInfo","catch","err","mapStateToProps","rootReducer","mapDispatchToProps","dispatch"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,GAAP,MAAgB,oBAAhB;AACA,SAASC,eAAe,IAAfA,gBAAT,EAA0BC,OAAO,IAAPA,QAA1B,QAAyC,4BAAzC;;IAEMC,W;;;;;AACJ,uBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,qFAAMA,KAAN;;AADiB,UAqBnBC,aArBmB,GAqBH,YAAM;AACpBL,MAAAA,GAAG,CAACM,UAAJ,CAAe,MAAKF,KAAL,CAAWG,IAAX,CAAgBC,EAA/B,EAAmCC,IAAnC,CAAwC,YAAM;AAC5C,cAAKC,QAAL,CAAc;AAAEC,UAAAA,kBAAkB,EAAE;AAAtB,SAAd;;AACAC,QAAAA,UAAU,CAAC,YAAM;AACf,gBAAKF,QAAL,CAAc;AAAEC,YAAAA,kBAAkB,EAAE;AAAtB,WAAd,EAA6C,YAAM;AACjD,kBAAKP,KAAL,CAAWF,OAAX,CAAmB,IAAnB;;AACA,kBAAKE,KAAL,CAAWS,OAAX,CAAmBC,IAAnB,CAAwB,QAAxB;AACD,WAHD;AAID,SALS,EAKP,IALO,CAAV;AAMD,OARD;AASD,KA/BkB;;AAAA,UAiCnBC,aAjCmB,GAiCH,UAACC,KAAD,EAAQC,GAAR,EAAgB;AAC9BC,MAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCH,KAAK,CAACI,MAAN,CAAaC,KAAnD;AACAH,MAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BH,KAAK,CAACI,MAAN,CAAaZ,EAAvC;;AACA,YAAKE,QAAL,qBACGO,GADH,EACSD,KAAK,CAACI,MAAN,CAAaC,KADtB;AAGD,KAvCkB;;AAAA,UAiDnBC,cAjDmB,GAiDF,UAAAC,CAAC,EAAI;AACpBA,MAAAA,CAAC,CAACC,cAAF;;AACA,UACE,MAAKC,KAAL,CAAWC,SAAX,CAAqBC,IAArB,OAAgC,EAAhC,IACA,MAAKF,KAAL,CAAWG,SAAX,CAAqBD,IAArB,OAAgC,EAFlC,EAGE;AACA,cAAKjB,QAAL,CAAc;AACZmB,UAAAA,mBAAmB,EAAE,IADT;AAEZC,UAAAA,uBAAuB,EAAE;AAFb,SAAd;AAID;;AACD,UAAI,MAAKL,KAAL,CAAWC,SAAX,KAAyB,MAAKD,KAAL,CAAWG,SAAxC,EAAmD;AACjD,cAAKlB,QAAL,CAAc;AACZmB,UAAAA,mBAAmB,EAAE,IADT;AAEZC,UAAAA,uBAAuB,EAAE;AAFb,SAAd;AAID,OALD,MAKO;AACL,cAAKpB,QAAL,CAAc;AAAEmB,UAAAA,mBAAmB,EAAE;AAAvB,SAAd;;AACA7B,QAAAA,GAAG,CAACsB,cAAJ,CAAmB,MAAKG,KAAL,CAAWM,MAA9B,EAAsC,MAAKN,KAAL,CAAWC,SAAjD,EAA4DjB,IAA5D,CAAiE;AAAA,iBAC/D,MAAKC,QAAL,CAAc;AAAEsB,YAAAA,0BAA0B,EAAE;AAA9B,WAAd,EAAoD;AAAA,mBAClDpB,UAAU,CAAC,YAAM;AACf,oBAAKF,QAAL,CAAc;AAAEsB,gBAAAA,0BAA0B,EAAE;AAA9B,eAAd;;AACA,oBAAK5B,KAAL,CAAWS,OAAX,CAAmBC,IAAnB,CAAwB,QAAxB;AACD,aAHS,EAGP,IAHO,CADwC;AAAA,WAApD,CAD+D;AAAA,SAAjE;AAQD;AACF,KA5EkB;;AAAA,UA8EnBmB,aA9EmB;AAAA;AAAA;AAAA;AAAA;AAAA,+BA8EH,iBAAMjB,KAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AACdA,gBAAAA,KAAK,CAACQ,cAAN;AAEIU,gBAAAA,WAHU,GAGI,MAAK9B,KAAL,CAAWG,IAHf;AAId2B,gBAAAA,WAAW,CAAC,WAAD,CAAX,GAA2B,MAAKT,KAAL,CAAWU,SAAtC;AACAD,gBAAAA,WAAW,CAAC,UAAD,CAAX,GAA0B,MAAKT,KAAL,CAAWW,QAArC;AAEIC,gBAAAA,cAPU,GAOO;AACnB7B,kBAAAA,EAAE,EAAE,MAAKiB,KAAL,CAAWa,UADI;AAEnBH,kBAAAA,SAAS,EAAE,MAAKV,KAAL,CAAWU,SAFH;AAGnBC,kBAAAA,QAAQ,EAAE,MAAKX,KAAL,CAAWW,QAHF;AAInBG,kBAAAA,OAAO,EAAE,MAAKd,KAAL,CAAWc,OAJD;AAKnBC,kBAAAA,IAAI,EAAE,MAAKf,KAAL,CAAWe,IALE;AAMnBC,kBAAAA,UAAU,EAAE,MAAKhB,KAAL,CAAWgB,UANJ;AAOnBC,kBAAAA,OAAO,EAAE,MAAKtC,KAAL,CAAWG,IAAX,CAAgBC;AAPN,iBAPP;AAiBdR,gBAAAA,GAAG,CAAC2C,WAAJ,CAAgBN,cAAhB,EAAgC5B,IAAhC,CAAqC;AAAA,yBACnCT,GAAG,CAAC4C,UAAJ,CAAeV,WAAf,EAA4BzB,IAA5B,CAAiC,YAAM;AACrC,0BAAKC,QAAL,CAAc;AAAEmC,sBAAAA,iBAAiB,EAAE;AAArB,qBAAd;;AACAjC,oBAAAA,UAAU,CAAC,YAAM;AACf,4BAAKF,QAAL,CAAc;AAAEmC,wBAAAA,iBAAiB,EAAE;AAArB,uBAAd;AACD,qBAFS,EAEP,IAFO,CAAV;AAGD,mBALD,CADmC;AAAA,iBAArC;;AAjBc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OA9EG;;AAAA;AAAA;AAAA;AAAA;;AAGjB,UAAKpB,KAAL,GAAa;AACXqB,MAAAA,SAAS,EAAE,KADA;AAEXX,MAAAA,SAAS,EAAE,OAFA;AAGXC,MAAAA,QAAQ,EAAE,OAHC;AAIXG,MAAAA,OAAO,EAAE,EAJE;AAKXE,MAAAA,UAAU,EAAE,EALD;AAMXH,MAAAA,UAAU,EAAE,EAND;AAOXO,MAAAA,iBAAiB,EAAE,KAPR;AAQXlC,MAAAA,kBAAkB,EAAE,KART;AASXe,MAAAA,SAAS,EAAE,EATA;AAUXE,MAAAA,SAAS,EAAE,EAVA;AAWXC,MAAAA,mBAAmB,EAAE,EAXV;AAYXC,MAAAA,uBAAuB,EAAE,EAZd;AAaXE,MAAAA,0BAA0B,EAAE,KAbjB;AAcXD,MAAAA,MAAM,EAAE;AAdG,KAAb;AAHiB;AAmBlB;;;;mCAsBc;AACb,aACE,KAAKN,KAAL,CAAWsB,KAAX,CAAiBC,MAAjB,GAA0B,CAA1B,IACA,KAAKvB,KAAL,CAAWwB,QAAX,CAAoBD,MAApB,GAA6B,CAD7B,IAEA,KAAKvB,KAAL,CAAWwB,QAAX,KAAwB,KAAKxB,KAAL,CAAWyB,eAHrC;AAKD;;;yCA0DoB;AAAA;;AACnB,UAAM1C,EAAE,GAAG,KAAKJ,KAAL,CAAW+C,KAAX,CAAiBC,MAAjB,CAAwB,IAAxB,CAAX;AACA,WAAK1C,QAAL,CAAc;AAAEqB,QAAAA,MAAM,EAAEvB;AAAV,OAAd;AACAR,MAAAA,GAAG,CAACqD,WAAJ,CAAgB7C,EAAhB,EAAoBC,IAApB,CAAyB,UAAAF,IAAI,EAAI;AAC/BW,QAAAA,OAAO,CAACC,GAAR,CAAYZ,IAAZ;AACAP,QAAAA,GAAG,CAACsD,eAAJ,CAAoB/C,IAAI,CAACgD,YAAL,CAAkB,CAAlB,CAApB,EACG9C,IADH,CACQ,UAAA+C,YAAY,EAAI;AACpBtC,UAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BqC,YAA/B;;AACA,UAAA,MAAI,CAAC9C,QAAL,CAAc;AACZyB,YAAAA,SAAS,EAAE5B,IAAI,CAAC4B,SADJ;AAEZC,YAAAA,QAAQ,EAAE7B,IAAI,CAAC6B,QAFH;AAGZW,YAAAA,KAAK,EAAExC,IAAI,CAACwC,KAHA;AAIZR,YAAAA,OAAO,EAAEiB,YAAY,CAACjB,OAJV;AAKZC,YAAAA,IAAI,EAAEgB,YAAY,CAAChB,IALP;AAMZC,YAAAA,UAAU,EAAEe,YAAY,CAACf,UANb;AAOZH,YAAAA,UAAU,EAAEkB,YAAY,CAAChD;AAPb,WAAd;AASD,SAZH,EAaGiD,KAbH,CAaS,UAAAC,GAAG;AAAA,iBAAIxC,OAAO,CAACC,GAAR,CAAYuC,GAAZ,CAAJ;AAAA,SAbZ;AAcD,OAhBD;AAiBD;;;6BAEQ;AAAA;;AACPxC,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKM,KAAL,CAAWU,SAAvB;AACA,aACE;AAAK,QAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,KAAKV,KAAL,CAAWd,kBAAX,IACC;AAAK,QAAA,KAAK,EAAC,4BAAX;AAAwC,QAAA,IAAI,EAAC,OAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oDAFJ,EAMG,KAAKc,KAAL,CAAWoB,iBAAX,IACC;AAAK,QAAA,KAAK,EAAC,6BAAX;AAAyC,QAAA,IAAI,EAAC,OAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iDAPJ,EAWE;AAAM,QAAA,QAAQ,EAAE,KAAKZ,aAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADF,EAGE;AAAK,QAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AACE,QAAA,IAAI,EAAC,MADP;AAEE,QAAA,SAAS,EAAC,cAFZ;AAGE,QAAA,IAAI,EAAC,YAHP;AAIE,QAAA,WAAW,EAAC,YAJd;AAKE,QAAA,QAAQ,EAAC,UALX;AAME,QAAA,KAAK,EAAE,KAAKR,KAAL,CAAWU,SANpB;AAOE,QAAA,QAAQ,EAAE,kBAAAnB,KAAK;AAAA,iBAAI,MAAI,CAACD,aAAL,CAAmBC,KAAnB,EAA0B,WAA1B,CAAJ;AAAA,SAPjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CADF,EAYE;AAAK,QAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AACE,QAAA,IAAI,EAAC,MADP;AAEE,QAAA,SAAS,EAAC,cAFZ;AAGE,QAAA,IAAI,EAAC,WAHP;AAIE,QAAA,WAAW,EAAC,WAJd;AAKE,QAAA,QAAQ,EAAC,UALX;AAME,QAAA,KAAK,EAAE,KAAKS,KAAL,CAAWW,QANpB;AAOE,QAAA,QAAQ,EAAE,kBAAApB,KAAK;AAAA,iBAAI,MAAI,CAACD,aAAL,CAAmBC,KAAnB,EAA0B,UAA1B,CAAJ;AAAA,SAPjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CAZF,CADF,CAHF,EA8BE;AAAK,QAAA,SAAS,EAAC,YAAf;AAA4B,QAAA,MAAM,EAAC,OAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AACE,QAAA,IAAI,EAAC,MADP;AAEE,QAAA,SAAS,EAAC,cAFZ;AAGE,QAAA,WAAW,EAAC,SAHd;AAIE,QAAA,KAAK,EAAE,KAAKS,KAAL,CAAWc,OAJpB;AAKE,QAAA,QAAQ,EAAE,kBAAAvB,KAAK;AAAA,iBAAI,MAAI,CAACD,aAAL,CAAmBC,KAAnB,EAA0B,SAA1B,CAAJ;AAAA,SALjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CA9BF,EAuCE;AAAK,QAAA,SAAS,EAAC,YAAf;AAA4B,QAAA,MAAM,EAAC,OAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AACE,QAAA,IAAI,EAAC,MADP;AAEE,QAAA,SAAS,EAAC,cAFZ;AAGE,QAAA,WAAW,EAAC,MAHd;AAIE,QAAA,KAAK,EAAE,KAAKS,KAAL,CAAWe,IAJpB;AAKE,QAAA,QAAQ,EAAE,kBAAAxB,KAAK;AAAA,iBAAI,MAAI,CAACD,aAAL,CAAmBC,KAAnB,EAA0B,MAA1B,CAAJ;AAAA,SALjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CAvCF,EAgDE;AAAK,QAAA,SAAS,EAAC,YAAf;AAA4B,QAAA,MAAM,EAAC,OAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AACE,QAAA,IAAI,EAAC,MADP;AAEE,QAAA,SAAS,EAAC,cAFZ;AAGE,QAAA,WAAW,EAAC,YAHd;AAIE,QAAA,KAAK,EAAE,KAAKS,KAAL,CAAWgB,UAJpB;AAKE,QAAA,QAAQ,EAAE,kBAAAzB,KAAK;AAAA,iBAAI,MAAI,CAACD,aAAL,CAAmBC,KAAnB,EAA0B,YAA1B,CAAJ;AAAA,SALjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CAhDF,EA0DE;AAAK,QAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAQ,QAAA,IAAI,EAAC,QAAb;AAAsB,QAAA,SAAS,EAAC,kCAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,CA1DF,CAXF,EA4EE;AAAK,QAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AACE,QAAA,SAAS,EAAC,kCADZ;AAEE,uBAAY,UAFd;AAGE,uBAAY,kBAHd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BADF,EASE;AAAK,QAAA,KAAK,EAAC,UAAX;AAAsB,QAAA,EAAE,EAAC,iBAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,KAAKS,KAAL,CAAWI,mBAAX,IACC;AAAK,QAAA,KAAK,EAAC,4BAAX;AAAwC,QAAA,IAAI,EAAC,OAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,KAAKJ,KAAL,CAAWK,uBADd,CAFJ,EAMG,KAAKL,KAAL,CAAWO,0BAAX,IACC;AAAK,QAAA,KAAK,EAAC,6BAAX;AAAyC,QAAA,IAAI,EAAC,OAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gEAPJ,EAYE;AAAK,QAAA,KAAK,EAAC,YAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAO,QAAA,GAAG,EAAC,uBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,EAEE;AACE,QAAA,KAAK,EAAE,KAAKP,KAAL,CAAWC,SADpB;AAEE,QAAA,QAAQ,EAAE,kBAAAH,CAAC;AAAA,iBAAI,MAAI,CAACb,QAAL,CAAc;AAAEgB,YAAAA,SAAS,EAAEH,CAAC,CAACH,MAAF,CAASC;AAAtB,WAAd,CAAJ;AAAA,SAFb;AAGE,QAAA,IAAI,EAAC,UAHP;AAIE,QAAA,KAAK,EAAC,cAJR;AAKE,QAAA,EAAE,EAAC,uBALL;AAME,QAAA,WAAW,EAAC,UANd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFF,CAZF,EAuBE;AAAK,QAAA,KAAK,EAAC,YAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAO,QAAA,GAAG,EAAC,uBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gCADF,EAEE;AACE,QAAA,KAAK,EAAE,KAAKI,KAAL,CAAWG,SADpB;AAEE,QAAA,QAAQ,EAAE,kBAAAL,CAAC;AAAA,iBAAI,MAAI,CAACb,QAAL,CAAc;AAAEkB,YAAAA,SAAS,EAAEL,CAAC,CAACH,MAAF,CAASC;AAAtB,WAAd,CAAJ;AAAA,SAFb;AAGE,QAAA,IAAI,EAAC,UAHP;AAIE,QAAA,KAAK,EAAC,cAJR;AAKE,QAAA,EAAE,EAAC,uBALL;AAME,QAAA,WAAW,EAAC,UANd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFF,CAvBF,EAmCE;AACE,QAAA,OAAO,EAAE,KAAKC,cADhB;AAEE,QAAA,IAAI,EAAC,QAFP;AAGE,QAAA,KAAK,EAAC,iBAHR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAnCF,CADF,CATF,CA5EF,EAmIE;AAAK,QAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AACE,QAAA,OAAO,EAAE,KAAKjB,aADhB;AAEE,QAAA,SAAS,EAAC,iCAFZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADF,CAnIF,CADF;AA8ID;;;;EAhRuBP,S;;AAmR1B,IAAM6D,eAAe,GAAG,SAAlBA,eAAkB,CAAAlC,KAAK,EAAI;AAC/B,SAAO;AACLlB,IAAAA,IAAI,EAAEkB,KAAK,CAACmC,WAAN,CAAkBrD;AADnB,GAAP;AAGD,CAJD;;AAMA,IAAMsD,kBAAkB,GAAG,SAArBA,kBAAqB,CAAAC,QAAQ,EAAI;AACrC,SAAO;AACL7D,IAAAA,eAAe,EAAE,yBAAAO,EAAE;AAAA,aAAIsD,QAAQ,CAAC7D,gBAAe,CAACO,EAAD,CAAhB,CAAZ;AAAA,KADd;AAELN,IAAAA,OAAO,EAAE,iBAAAK,IAAI;AAAA,aAAIuD,QAAQ,CAAC5D,QAAO,CAACK,IAAD,CAAR,CAAZ;AAAA;AAFR,GAAP;AAID,CALD;;AAOA,eAAeR,OAAO,CACpB4D,eADoB,EAEpBE,kBAFoB,CAAP,CAGb1D,WAHa,CAAf","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport API from \"../../services/api\";\nimport { getOrderHistory, setUser } from \"../../store/action/actions\";\n\nclass UserProfile extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isLoading: false,\n      firstName: \"Idris\",\n      lastName: \"Hamid\",\n      address: \"\",\n      postalCode: \"\",\n      shippingId: \"\",\n      updatConfirmation: false,\n      deleteConfirmation: false,\n      password1: \"\",\n      password2: \"\",\n      changePasswordError: \"\",\n      changePasswordErrorText: \"\",\n      changePasswordConfirmation: false,\n      userId: \"\"\n    };\n  }\n\n  deleteAccount = () => {\n    API.deleteUser(this.props.user.id).then(() => {\n      this.setState({ deleteConfirmation: true });\n      setTimeout(() => {\n        this.setState({ deleteConfirmation: false }, () => {\n          this.props.setUser(null);\n          this.props.history.push(\"/login\");\n        });\n      }, 3000);\n    });\n  };\n\n  profileChange = (event, key) => {\n    console.log(\"value you are typing: \", event.target.value);\n    console.log(\"updating: \", event.target.id);\n    this.setState({\n      [key]: event.target.value\n    });\n  };\n\n  validateForm() {\n    return (\n      this.state.email.length > 0 &&\n      this.state.password.length > 0 &&\n      this.state.password === this.state.confirmPassword\n    );\n  }\n\n  changePassword = e => {\n    e.preventDefault();\n    if (\n      this.state.password1.trim() === \"\" ||\n      this.state.password2.trim() === \"\"\n    ) {\n      this.setState({\n        changePasswordError: true,\n        changePasswordErrorText: \"You have to fill both password fields\"\n      });\n    }\n    if (this.state.password1 !== this.state.password2) {\n      this.setState({\n        changePasswordError: true,\n        changePasswordErrorText: \"Passwords must match\"\n      });\n    } else {\n      this.setState({ changePasswordError: false });\n      API.changePassword(this.state.userId, this.state.password1).then(() =>\n        this.setState({ changePasswordConfirmation: true }, () =>\n          setTimeout(() => {\n            this.setState({ changePasswordConfirmation: false });\n            this.props.history.push(\"/login\");\n          }, 3000)\n        )\n      );\n    }\n  };\n\n  profileSubmit = async event => {\n    event.preventDefault();\n\n    let updatedUser = this.props.user;\n    updatedUser[\"firstName\"] = this.state.firstName;\n    updatedUser[\"lastName\"] = this.state.lastName;\n\n    let updateShipping = {\n      id: this.state.shippingId,\n      firstName: this.state.firstName,\n      lastName: this.state.lastName,\n      address: this.state.address,\n      city: this.state.city,\n      postalCode: this.state.postalCode,\n      user_id: this.props.user.id\n    };\n\n    API.putShipping(updateShipping).then(() =>\n      API.updateUser(updatedUser).then(() => {\n        this.setState({ updatConfirmation: true });\n        setTimeout(() => {\n          this.setState({ updatConfirmation: false });\n        }, 4000);\n      })\n    );\n  };\n\n  componentWillMount() {\n    const id = this.props.match.params[\"id\"];\n    this.setState({ userId: id });\n    API.getUserById(id).then(user => {\n      console.log(user);\n      API.getshippingById(user.shippingList[0])\n        .then(shippingInfo => {\n          console.log(\"shipping info: \", shippingInfo);\n          this.setState({\n            firstName: user.firstName,\n            lastName: user.lastName,\n            email: user.email,\n            address: shippingInfo.address,\n            city: shippingInfo.city,\n            postalCode: shippingInfo.postalCode,\n            shippingId: shippingInfo.id\n          });\n        })\n        .catch(err => console.log(err));\n    });\n  }\n\n  render() {\n    console.log(this.state.firstName);\n    return (\n      <div className=\"signup-form\">\n        {this.state.deleteConfirmation && (\n          <div class=\"alert alert-danger mx-auto\" role=\"alert\">\n            The account has been parmenantly deleted\n          </div>\n        )}\n        {this.state.updatConfirmation && (\n          <div class=\"alert alert-success mx-auto\" role=\"alert\">\n            The profile been successfully updated\n          </div>\n        )}\n        <form onSubmit={this.profileSubmit}>\n          <h2>Profile</h2>\n\n          <div className=\"form-group\">\n            <div className=\"row\">\n              <div className=\"col-xs-6\">\n                <input\n                  type=\"text\"\n                  className=\"form-control\"\n                  name=\"first_name\"\n                  placeholder=\"First Name\"\n                  required=\"required\"\n                  value={this.state.firstName}\n                  onChange={event => this.profileChange(event, \"firstName\")}\n                />\n              </div>\n              <div className=\"col-xs-6\">\n                <input\n                  type=\"text\"\n                  className=\"form-control\"\n                  name=\"last_name\"\n                  placeholder=\"Last Name\"\n                  required=\"required\"\n                  value={this.state.lastName}\n                  onChange={event => this.profileChange(event, \"lastName\")}\n                />\n              </div>\n            </div>\n          </div>\n\n          <div className=\"form-group\" bsSize=\"large\">\n            <input\n              type=\"text\"\n              className=\"form-control\"\n              placeholder=\"Address\"\n              value={this.state.address}\n              onChange={event => this.profileChange(event, \"address\")}\n            />\n          </div>\n          <div className=\"form-group\" bsSize=\"large\">\n            <input\n              type=\"text\"\n              className=\"form-control\"\n              placeholder=\"city\"\n              value={this.state.city}\n              onChange={event => this.profileChange(event, \"city\")}\n            />\n          </div>\n          <div className=\"form-group\" bsSize=\"large\">\n            <input\n              type=\"text\"\n              className=\"form-control\"\n              placeholder=\"postalcode\"\n              value={this.state.postalCode}\n              onChange={event => this.profileChange(event, \"postalCode\")}\n            />\n          </div>\n\n          <div className=\"form-group\">\n            <button type=\"submit\" className=\"btn btn-success btn-lg btn-block\">\n              UPDATE\n            </button>\n          </div>\n        </form>\n\n        <div className=\"form-group\">\n          <button\n            className=\"btn btn-warning btn-lg btn-block\"\n            data-toggle=\"collapse\"\n            data-target=\"#collapseExample\"\n          >\n            CHANGE PASSWORD\n          </button>\n\n          <div class=\"collapse\" id=\"collapseExample\">\n            <form>\n              {this.state.changePasswordError && (\n                <div class=\"alert alert-danger mx-auto\" role=\"alert\">\n                  {this.state.changePasswordErrorText}\n                </div>\n              )}\n              {this.state.changePasswordConfirmation && (\n                <div class=\"alert alert-success mx-auto\" role=\"alert\">\n                  Password has been successfully changed. Login again.\n                </div>\n              )}\n\n              <div class=\"form-group\">\n                <label for=\"exampleInputPassword1\">New password</label>\n                <input\n                  value={this.state.password1}\n                  onChange={e => this.setState({ password1: e.target.value })}\n                  type=\"password\"\n                  class=\"form-control\"\n                  id=\"exampleInputPassword1\"\n                  placeholder=\"Password\"\n                />\n              </div>\n              <div class=\"form-group\">\n                <label for=\"exampleInputPassword1\">Confirm new password</label>\n                <input\n                  value={this.state.password2}\n                  onChange={e => this.setState({ password2: e.target.value })}\n                  type=\"password\"\n                  class=\"form-control\"\n                  id=\"exampleInputPassword1\"\n                  placeholder=\"Password\"\n                />\n              </div>\n\n              <button\n                onClick={this.changePassword}\n                type=\"submit\"\n                class=\"btn btn-primary\"\n              >\n                Change\n              </button>\n            </form>\n          </div>\n        </div>\n        <div className=\"form-group\">\n          <button\n            onClick={this.deleteAccount}\n            className=\"btn btn-danger btn-lg btn-block\"\n          >\n            DELETE ACCOUNT\n          </button>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    user: state.rootReducer.user\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    getOrderHistory: id => dispatch(getOrderHistory(id)),\n    setUser: user => dispatch(setUser(user))\n  };\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(UserProfile);\n"]},"metadata":{},"sourceType":"module"}